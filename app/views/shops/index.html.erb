<h1><%= "Shops - " + @previous.name %></h1>

<ul>
  <% for shop in @shops %>
      <li>
        <% link = if @previous
                    if @previous.class == City
                      shop_city_shop_path(@previous, shop)
                    else
                      [@previous, shop]
                    end
                  else
                    shop
                  end
        %>
        <%= link_to shop.address, link %>
      </li>
  <% end %>
</ul>